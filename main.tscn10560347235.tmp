[gd_scene load_steps=39 format=3 uid="uid://dtegvpshlnb4n"]

[ext_resource type="Script" uid="uid://c6k4hwk6mne5o" path="res://код/игрок/player.gd" id="1_4c57u"]
[ext_resource type="Script" uid="uid://b7irgt40pjecj" path="res://код/ui.gd" id="1_ycdy4"]
[ext_resource type="Texture2D" uid="uid://caix5uqj7d4dx" path="res://ассеты/изображения/B_witch_idle.png" id="2_dg77c"]
[ext_resource type="Script" uid="uid://cupufbxw5wehj" path="res://код/игрок/manager_states.gd" id="2_efxa6"]
[ext_resource type="Script" uid="uid://clnvkojl7hwwr" path="res://код/игрок/idle.gd" id="3_dg77c"]
[ext_resource type="Script" uid="uid://c33vneup0uuwy" path="res://код/игрок/move.gd" id="4_ycdy4"]
[ext_resource type="Script" uid="uid://0byachyfdwkr" path="res://код/игрок/interact.gd" id="5_w48qg"]
[ext_resource type="Script" uid="uid://kqg1665sdbw6" path="res://код/игрок/manager_states_actions.gd" id="6_vivmo"]
[ext_resource type="Script" uid="uid://c3jei5peab2w4" path="res://код/игрок/idleAction.gd" id="7_2cqfq"]
[ext_resource type="Script" uid="uid://bjj7yuuua54qx" path="res://код/игрок/shoot.gd" id="8_yaehf"]
[ext_resource type="Script" uid="uid://tfy328rwfgil" path="res://код/игрок/heal.gd" id="9_074og"]
[ext_resource type="Script" uid="uid://byvgkwmd0b4t3" path="res://код/игрок/reload.gd" id="10_cegan"]
[ext_resource type="Script" uid="uid://tekkok4cc727" path="res://код/enemy.gd" id="12_dg77c"]
[ext_resource type="Script" uid="uid://dkjfs13k2nrfr" path="res://код/интерактивное/test.gd" id="13_w48qg"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_7dm0k"]
sky_top_color = Color(0.71475536, 0.28173006, 0.3544572, 1)
sky_horizon_color = Color(0.68867075, 0.5726644, 0.58184624, 1)
ground_horizon_color = Color(0.68867075, 0.5726644, 0.58184624, 1)

[sub_resource type="Sky" id="Sky_ig7tw"]
sky_material = SubResource("ProceduralSkyMaterial_7dm0k")

[sub_resource type="Environment" id="Environment_0xm2m"]
background_mode = 2
sky = SubResource("Sky_ig7tw")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_h2yge"]
albedo_color = Color(1, 0.6509804, 0.43137255, 1)

[sub_resource type="BoxMesh" id="BoxMesh_7dm0k"]
material = SubResource("StandardMaterial3D_h2yge")
size = Vector3(20, 0, 20)

[sub_resource type="BoxMesh" id="BoxMesh_1bvp3"]

[sub_resource type="BoxMesh" id="BoxMesh_4c57u"]
size = Vector3(0.2, 1, 1)

[sub_resource type="BoxMesh" id="BoxMesh_lquwl"]
size = Vector3(0.2, 2, 1)

[sub_resource type="AtlasTexture" id="AtlasTexture_ycdy4"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 0, 32, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_w48qg"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 48, 32, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_vivmo"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 96, 32, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_2cqfq"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 144, 32, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_yaehf"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 192, 32, 48)

[sub_resource type="AtlasTexture" id="AtlasTexture_074og"]
atlas = ExtResource("2_dg77c")
region = Rect2(0, 240, 32, 48)

[sub_resource type="SpriteFrames" id="SpriteFrames_cegan"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_ycdy4")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_w48qg")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_vivmo")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_2cqfq")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_yaehf")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_074og")
}],
"loop": true,
"name": &"idle",
"speed": 5.0
}, {
"frames": [],
"loop": true,
"name": &"new_animation",
"speed": 5.0
}]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_7dm0k"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ig7tw"]

[sub_resource type="BoxShape3D" id="BoxShape3D_efxa6"]
size = Vector3(5, 2, 5)

[sub_resource type="SphereMesh" id="SphereMesh_4c57u"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_efxa6"]
albedo_color = Color(0, 0.40392157, 1, 1)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_ycdy4"]
points = PackedVector3Array(-0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, -0.5, -0.5, -0.5, -0.5, 0.5, -0.5, 0.5, -0.5)

[sub_resource type="BoxMesh" id="BoxMesh_dg77c"]

[sub_resource type="BoxShape3D" id="BoxShape3D_ycdy4"]
size = Vector3(1, 2, 1)

[sub_resource type="CapsuleMesh" id="CapsuleMesh_dg77c"]

[node name="main" type="Node3D"]

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="UI" type="Control" parent="CanvasLayer" node_paths=PackedStringArray("player")]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
script = ExtResource("1_ycdy4")
player = NodePath("../../player")

[node name="Label" type="Label" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -1.0
offset_bottom = 23.0
grow_horizontal = 0
theme_override_font_sizes/font_size = 24
text = "Скрапа: 0"

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_0xm2m")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.9707165, -0.104554735, 0.21628188, 0, 0.9003188, 0.4352311, -0.2402281, 0.42248598, -0.8739543, 0, 0, 0)
shadow_enabled = true

[node name="floor" type="CSGMesh3D" parent="."]
use_collision = true
mesh = SubResource("BoxMesh_7dm0k")

[node name="CSGMesh3D" type="CSGMesh3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.48651445, 0)
visible = false
mesh = SubResource("BoxMesh_1bvp3")

[node name="CSGMesh3D2" type="CSGMesh3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 4.1672783, -2.2845414, 1.0008639, -0.39879537)
use_collision = true
mesh = SubResource("BoxMesh_4c57u")

[node name="CSGMesh3D3" type="CSGMesh3D" parent="."]
transform = Transform3D(-4.3711385e-08, 0, -4.167278, 0, 0.99999994, 0, 1, 0, -1.821575e-07, -0.3028159, 1.0008639, -2.4312527)
use_collision = true
mesh = SubResource("BoxMesh_lquwl")

[node name="player" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
script = ExtResource("1_4c57u")

[node name="AnimatedSprite3D" type="AnimatedSprite3D" parent="player"]
visible = false
pixel_size = 0.05
billboard = 1
texture_filter = 0
sprite_frames = SubResource("SpriteFrames_cegan")
animation = &"idle"
autoplay = "idle"

[node name="MeshInstance3D" type="MeshInstance3D" parent="player"]
mesh = SubResource("CapsuleMesh_7dm0k")

[node name="CollisionShape3D" type="CollisionShape3D" parent="player"]
shape = SubResource("CapsuleShape3D_ig7tw")

[node name="ManagerStates" type="Node" parent="player"]
script = ExtResource("2_efxa6")

[node name="Idle" type="Node" parent="player/ManagerStates" node_paths=PackedStringArray("marker")]
script = ExtResource("3_dg77c")
marker = NodePath("../../../CSGMesh3D4")

[node name="Move" type="Node" parent="player/ManagerStates" node_paths=PackedStringArray("camera")]
script = ExtResource("4_ycdy4")
camera = NodePath("../../Camera3D")

[node name="Interact" type="Node" parent="player/ManagerStates"]
script = ExtResource("5_w48qg")

[node name="ManagerStatesActions" type="Node" parent="player"]
script = ExtResource("6_vivmo")

[node name="Idle" type="Node" parent="player/ManagerStatesActions" node_paths=PackedStringArray("ManagerState")]
script = ExtResource("7_2cqfq")
ManagerState = NodePath("../../ManagerStates")

[node name="Shoot" type="Node" parent="player/ManagerStatesActions"]
script = ExtResource("8_yaehf")

[node name="Heal" type="Node" parent="player/ManagerStatesActions" node_paths=PackedStringArray("sfm")]
script = ExtResource("9_074og")
sfm = NodePath("../../ManagerStates")

[node name="Reload" type="Node" parent="player/ManagerStatesActions" node_paths=PackedStringArray("sfm")]
script = ExtResource("10_cegan")
sfm = NodePath("../../ManagerStates")

[node name="Aim" type="Node" parent="player/ManagerStatesActions"]

[node name="Interact" type="Node" parent="player/ManagerStatesActions"]
script = ExtResource("5_w48qg")

[node name="Camera3D" type="Camera3D" parent="player"]
transform = Transform3D(0.70710677, -0.45451945, 0.5416752, 0, 0.76604444, 0.6427876, -0.70710677, -0.45451945, 0.5416752, 8, 8.565477, 8)
projection = 1
current = true
size = 10.0

[node name="area_interact_object" type="Area3D" parent="player"]
collision_layer = 8
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="player/area_interact_object"]
shape = SubResource("BoxShape3D_efxa6")

[node name="CSGMesh3D4" type="CSGMesh3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
mesh = SubResource("SphereMesh_4c57u")
material = SubResource("StandardMaterial3D_efxa6")

[node name="StaticBody3D2" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7, 1, 3)
collision_layer = 5
collision_mask = 9
script = ExtResource("13_w48qg")

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D2"]
shape = SubResource("ConvexPolygonShape3D_ycdy4")

[node name="MeshInstance3D" type="MeshInstance3D" parent="StaticBody3D2"]
mesh = SubResource("BoxMesh_dg77c")
skeleton = NodePath("../..")

[node name="StaticBody3D" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 1, -4)
script = ExtResource("12_dg77c")

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D"]
shape = SubResource("BoxShape3D_ycdy4")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="StaticBody3D"]
mesh = SubResource("CapsuleMesh_dg77c")
skeleton = NodePath("../..")

[connection signal="body_entered" from="player/area_interact_object" to="player" method="interact_object_detected"]
